# Use the official Nginx base image
FROM nginx: 1.25.3

# Copy custom Nginx configuration file to the container
COPY nginx.conf /etc/nginx/nginx.conf

# Create a non-root user to run Nginx
RUN adduser --disabled-password --gecos '' nginxuser && \
    chown -R nginxuser:nginxuser /var/cache/nginx /var/run /var/log/nginx /etc/nginx && \
    touch /var/run/nginx.pid && \
    chown -R nginxuser:nginxuser /var/run/nginx.pid /var/log/nginx

# Switch to the non-root user
USER nginxuser

# Expose port 8080 on the host to port 80 in the container
EXPOSE 8080

# Command to start Nginx when the container runs
CMD ["nginx", "-g", "daemon off;"]
